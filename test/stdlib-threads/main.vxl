import io;
import threads;

var currentTurn = 0;

function repeat(value, times) {
    var myTurn = currentTurn;

    for (var i = 0; i < times; i++) {
        while (currentTurn != myTurn) {}

        io.println(value);

        currentTurn = (currentTurn + 1) % 3;
    }
}

var thread1 = new threads.Thread(repeat, ["Thread 1", 5]);
var thread2 = new threads.Thread(repeat, ["Thread 2", 5]);

thread1.start();
thread2.start();

repeat("Main executor", 5);

while (!thread1.hasFinished()) {}

thread1.close();
io.println("Closed thread 1");

while (!thread2.hasFinished()) {}

thread2.close();
io.println("Closed thread 2");